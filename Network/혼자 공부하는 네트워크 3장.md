# 혼자 공부하는 네트워크 3장

라우팅 - 패킷이 이동할 최적의 경로를 결정하는 것

라우터 - 라우팅을 도와주는 네트워크 계층의 장비

MAC 주소 - 수신인(특정 식별), 물리 주소라 부름, 기기(NIC)마다 할당되는 주소

IP 주소 - 수신지(네트워크 주소), 논리 주소, DHCP를 통하여 자동으로 할당받거나 수동으로 할당 가능

- DHCP - IP 주소 할당



IPV4

IP 주소 지정 : IP 주소를 바탕으로 송수신 대상을 지정하는 것

IP 단편화 : MTU보다 클 경우 패킷을 나누는 작업

​	MTU : 한 번에 전송가능한 IP 패킷의 최대 크기, 일반적으로 1500byte

![스크린샷 2024-10-09 오후 2.34.35](/Users/yoonseil/Desktop/TIL/Network/혼자 공부하는 네트워크 3장.assets/스크린샷 2024-10-09 오후 2.34.35-8476316.png)

- 식별자 : 패킷 번호
- 플래그 
  - DF : 1일 경우, 단편화 금지
  - MF : 0일 경우, 마지막 패킷임을 표기
- 단편화 오프셋
  - 첫 데이터로 부터 얼마나 오프셋 되어있는 지를 나타냄. 이를 바탕으로 패킷을 재조합할 수 있음.
- TTL : 패킷의 수명
  - 라우터를 거칠 때마다 TTL이 1씩 감소
  - TTL값이 0일 경우 폐기
  - hop : 패킷이 호스트 또는 라우터에 한 번 전달되는 것
  - 이유 : 무의미한 패킷이 네트워크상에 지속적으로 남아있는 것을 방지하기 위하여
  - 폐기된 경우, 호스트에서 시간 초과(time exceeded)를 알려줌
- 프로토콜
  - 상위 계층의 프로토콜 공유 UDP : 17, TCP : 6
- 송신지 / 수신지 IP 주소



IPV6

![스크린샷 2024-10-09 오후 2.45.52](/Users/yoonseil/Desktop/TIL/Network/혼자 공부하는 네트워크 3장.assets/스크린샷 2024-10-09 오후 2.45.52-8476308.png)

-  정의 : Ipv4의 개수가 모자라서 만들어짐, 32비트 -> 128비트
- 다음 헤더 : 기본 헤더 외 확장된 헤더를 가리킴
  - 홉간 옵션, 수신지 옵션, 라우팅 , 단편, 암호화와 인증 등의 확장 헤더가 존재
- 홉 제한 : TTL과 똑같은 수명



ARP (Address Resolution Protocol)

- IP 주소를 이용하여 MAC 주소를 알아내는 프로토콜



IP주소

- 네트워크 주소
- 호스트 주소 
- 클래스 : 
- 클래스리스 주소체계 : 
  - 서브넷 마스크

- 공인 IP 주소 사설 IP 주소
  - 공인 IP : ISP나 국가 IP 
  - 사설 IP : 사설 네트워크 내 특정 주소들은 사설로 사용할 수 있음. (그래서 중복 될 수 있음), 라우터가 이 역할을 해줌
  - NAT : 사설 IP과 외부 네트워크와 통신하는 기술
    - 사설 네트워크 IP => 공인 IP => 통신
- 정적 IP 주소 동적 IP 주소
  - 정적 IP 주소 : 호스트에 수동으로 부여
    - 게이트웨이 : 호스트가 속한 네트워크 외부로 나가기 위한 첫 번째  상황에 따라 공유기(라우터) 주소를 자주 의미함.
  - DHCP(dynamic host configuration protocol) : IP 동적 할당을 진행하는 프로토콜

라우팅

- 메트릭 : 해당 경로를 이동하는 데 드는 비용. 대역폭이 낮으면 매트릭이 낮을수록 싸다. (대역폭이 높다 = 메트릭이 낮다)



IP 통신의 한계 : 신뢰할 수 없는 통신과 비연결형 통신을 수행함



# 전송계층 : IP 통신의 한계 극복

- 최선형 전달 : 패킷 데이터 손실, 중복된 패킷 전송, 순서대로 전송 등에 대해서 책임지지 않고 보장하지 않음 (비신뢰성)
- 비연결형 : 송수신 호스트 간 사전 연결 작업을 수립하지 않음.
- Why? : 성능 이슈 때문에 일단 이렇게 구현



[극복]

- 연결형 통신 : TCP
- 신뢰성 : 오류 제어, 흐름 제어, 혼잡 제어 제공
- UDP : 속도를 위하여 비연결, 비신뢰성 통신이 필요할 때 사용
- ICMP : ping, 등 인터넷 비 신뢰성을 보완하기 위한 프로토콜 (신뢰성을 보장하지는 않음)



# 전송계층 : 응용과의 연결 다리 포트

- 포트 : 단순 클라이언트까지 전달 이후 특정 애플리케이션에 전달하기 위한 정보 (애플리케이션 식별자)

  - 192.168.0.15 :8080 , 특정 호스트에 특정 애플리케이션을 식별

- 포트 포워딩 : "외부 IP: 포트" 와 "사설IP 포트"를 매칭시킴.

  

# TCP

![스크린샷 2024-10-09 오후 9.18.04](/Users/yoonseil/Desktop/TIL/Network/혼자 공부하는 네트워크 3장.assets/스크린샷 2024-10-09 오후 9.18.04.png)

![스크린샷 2024-10-09 오후 9.18.53](/Users/yoonseil/Desktop/TIL/Network/혼자 공부하는 네트워크 3장.assets/스크린샷 2024-10-09 오후 9.18.53-8476338.png)

- stateful 프로토콜
- 연결 수립, 오류제어, 혼잡 제어, 흐름 제어 수행

![스크린샷 2024-10-09 오후 9.22.53](/Users/yoonseil/Desktop/TIL/Network/혼자 공부하는 네트워크 3장.assets/스크린샷 2024-10-09 오후 9.22.53-8476583.png)

[오류 검출과 재 전송]

세그먼트를 재전송해야하는 경우

- ACK 세그먼트 수신 시, 같은 요청이 중복될 경우
- 타임아웃 발생 시 : 재전송 타이머의 시간이 모두 종료된 경우

ARQ

- stop and wait : 모든 메시지에 대해서, 응답이 올 때까지 기다림, 현재는 잘 안 씀
- Go-Back-N : n번 응답이 손실되면 n번부터 모든 세그먼트를 다시 보내기
  - 파이프라이닝 : 메시지를 연속해서 전속하는 기술
  - CACK : 누적 확인 응답
- Selective Repeat ARQ : 응답 받지 못한 세그먼트만 찾아서 재전송



[흐름제어]

- 수신 버퍼 : 임시로 저장되는 공간
- 버퍼 오버플로 : 버퍼가 넘치는 현상
- 슬라이딩 윈도우 : 최대 세그먼트 개수를 정하고 한 칸씩 움직임



[혼잡 제어]

혼잡 : 네트워크 트래픽으로 인해 패킷의 처리속도가 늦어지거나 유실될 수 있는 상황

- 혼잡으로 인하여 전송률이 떨어지는 현상을 혼잡붕괴라 함.
- 호스트가 혼잡도를 파악하고 조절하며 전송함. (혼잡윈도우)
- 혼잡 제어 알고리즘 : 혼잡 윈도우의 크기를 조정함
  - AIMD : 혼잡하지 않을 시, 1씩 증가, 혼잡 시, 절반으로 감소
  - 느린 시작 알고리즘 : 1로 시작하여 2배씩 늘림. 느린 시작임계치에 도달 시 혼잡 회피 알고리즘 수행
  - 혼잡 회피 알고리즘 : 1MSS씩 증가시키는 알고리즘. 타임아웃 발생 시, 윈도우는 절반으로 변경 후, 느린 시작
  - 빠른 회복 알고리즘 : 세번의 중복 ACK 세그먼트 수신 시, 빠른 회복 알고리즘을 수행함. 타임아웃이 발생 시, 윈도우 크기는 1, 느린 시작 임계치를 절반으로 바꾼 후 느린 시작을 수행합니다.



# UDP

![스크린샷 2024-10-09 오후 9.24.15](/Users/yoonseil/Desktop/TIL/Network/혼자 공부하는 네트워크 3장.assets/스크린샷 2024-10-09 오후 9.24.15-8476667.png)

- stateless 프로토콜
- 스트리밍, 인터넷 통화 등 실시간성이 강조될 때 많이 사용됨
- 



# 참고자료

https://developer.mozilla.org/ko/docs/Web/HTTP/Connection_management_in_HTTP_1.x